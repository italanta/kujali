<volk-finance-volk-main-page>
  <div fullContent>
      <volk-finance-toolbar>
          <volk-finance-search-header-card header (toogleFilterEvent)='toogleFilter($event)'
              (searchTableEvent)='applyFilter($event)' [tableData]="allTableData">
              <div add-new>
                <button *hasWriteAccess="CAN_CREATE_INVOICES" mat-flat-button (click)="createInvoice()" class="add-new"> 
                    <i class="bi bi-plus-circle-fill"></i> 
                    {{'HEADER-ADD-NEW' | transloco}}
                </button>
              </div>
          </volk-finance-search-header-card>
      </volk-finance-toolbar>

      <div *ngIf="showFilter" class="filter-section">
          <volk-invoices-filter (filterChanged)='fieldsFilter($event)'>
          </volk-invoices-filter>
      </div>

      <div class="table-container" fxLayout="column" fxLayoutAlign="start center" fxLayoutGap="20px">
          <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">

              <!-- Invoice title -->
              <!-- <ng-container matColumnDef="title">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>{{"INVOICES.TABLE.TITLE" | transloco}}</th>
                  <td mat-cell *matCellDef="let invoice" (click)="viewInvoice(invoice.id)"> {{invoice.title}} </td>
              </ng-container> -->

              <!-- Number Column -->
              <ng-container matColumnDef="number">
                  <th mat-header-cell *matHeaderCellDef> {{"INVOICES.TABLE.INV-NUMBER" | transloco}} </th>
                  <td mat-cell *matCellDef="let invoice" (click)="viewInvoice(invoice.id)">
                      <div>{{invoice.number}}</div>
                  </td>
              </ng-container>

              <ng-container matColumnDef="amount">
                  <th mat-header-cell *matHeaderCellDef> {{"INVOICES.TABLE.AMOUNT" | transloco}} </th>
                  <td mat-cell *matCellDef="let invoice" (click)="viewInvoice(invoice.id)">
                      <div>{{getTotalAmount(invoice.products) | currency : invoice.currency}}</div>
                  </td>
              </ng-container>

              <!-- date Column -->
              <ng-container matColumnDef="date">
                  <th mat-header-cell *matHeaderCellDef> {{"INVOICES.TABLE.DATE" | transloco}} </th>
                  <td mat-cell *matCellDef="let invoice" (click)="viewInvoice(invoice.id)">
                      <div *ngIf="invoice.date; else dash">{{getDate(invoice.date)}}</div>
                      <ng-template #dash> - </ng-template>
                  </td>
              </ng-container>

              <!-- dueDate Column -->
              <ng-container matColumnDef="dueDate">
                  <th mat-header-cell *matHeaderCellDef> {{"INVOICES.TABLE.DUE-DATE" | transloco}} </th>
                  <td mat-cell *matCellDef="let invoice" (click)="viewInvoice(invoice.id)">
                      <div *ngIf="invoice.dueDate; else dash">{{getDate(invoice.dueDate)}}</div>
                      <ng-template #dash> - </ng-template>
                  </td>
              </ng-container>

              <!-- Company Column -->
              <ng-container matColumnDef="customer">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> {{"INVOICES.TABLE.COMPANY" | transloco}} </th>
                  <td mat-cell *matCellDef="let invoice" (click)="viewInvoice(invoice.id)">
                      <div *ngIf="invoice.customer; else dash">{{getCompanyNames(invoice.customer)}}</div>
                      <ng-template #dash> - </ng-template>
                  </td>
              </ng-container>

              <!-- Contact Column -->
              <ng-container matColumnDef="contact">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header> {{"INVOICES.TABLE.CONTACT" | transloco}} </th>
                  <td mat-cell *matCellDef="let invoice" (click)="viewInvoice(invoice.id)">
                      <div *ngIf="invoice.contact; else dash">{{getContactNames(invoice.contact)}}</div>
                      <ng-template #dash> - </ng-template>
                  </td>
              </ng-container>

              <!-- Status Column -->
              <ng-container matColumnDef="status">
                  <th mat-header-cell *matHeaderCellDef> {{"INVOICES.TABLE.STATUS" | transloco}} </th>
                  <td mat-cell *matCellDef="let invoice" (click)="viewInvoice(invoice.id)">
                      <div *ngIf="invoice.status; else dash">{{invoice.status}}</div>
                      <ng-template #dash> - </ng-template>
                  </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
      </div>
      <mat-paginator [pageSizeOptions]="[20, 30]" showFirstLastButtons>
      </mat-paginator>
  </div>
</volk-finance-volk-main-page>